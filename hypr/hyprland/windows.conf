########################################
# WINDOWS & LAYERS – Waybar compatible
########################################
# ┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
# ┃ WINDOWS & LAYERS - Cấu hình quy tắc cho cửa sổ (windowrulev2) và layer (layerrule) trong Hyprland (tương thích Waybar) ┃
# ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
# Tài liệu chính thức: https://wiki.hypr.land/Configuring/Window-Rules/ (cho windowrulev2) và https://wiki.hypr.land/Configuring/Layer-Rules/ (cho layerrule)
# Phần này định nghĩa quy tắc cho cửa sổ (windows) và layer (overlays như Waybar, Wofi, SwayNC) để tùy chỉnh hành vi, opacity, floating, animation, v.v.
# - windowrulev2: Áp dụng cho cửa sổ thông thường (app windows); hỗ trợ regex cho class/title để match linh hoạt.
# - layerrule: Áp dụng cho layers (gtk-layer-shell như Waybar); không dùng opacity ở đây vì layer thường transparent tự nhiên.
# Lưu ý quan trọng:
# - Quy tắc áp dụng theo thứ tự (từ trên xuống); rule sau có thể override rule trước nếu match.
# - Regex case-insensitive với (?i) để match không phân biệt hoa/thường (ví dụ: Kitty hoặc kitty).
# - Reload config (hyprctl reload) áp dụng ngay cho windowrulev2/layerrule mà không cần restart.
# - Debug: Tra class/title của cửa sổ bằng 'hyprctl clients' (xem active windows); hoặc 'xprop' cho XWayland apps.
# - Pro Tips: Kết hợp với opacity để ricing (semi-transparent); dùng float/center cho dialogs để UI đẹp; tránh over-rule để giữ performance.

# 1) BUGFIX & DEFAULT (áp cho cửa sổ thường, không tác động layer) - Các quy tắc fix bug cơ bản và default behavior
# - suppressevent maximize: Ngăn event maximize (fix bug một số app tự fullscreen không mong muốn).
# - nofocus: Bỏ focus cho cửa sổ rỗng (class/title empty, XWayland, floating, không fullscreen/pinned) - fix focus steal từ popup ẩn.
windowrulev2 = suppressevent maximize, class:.* # Ngăn chặn event maximize cho tất cả class (fix bug app tự fullscreen sai)
windowrulev2 = nofocus, class:^$, title:^$, xwayland:1, floating:1, fullscreen:0, pinned:0 # Bỏ focus cho cửa sổ rỗng XWayland floating (fix focus steal từ background popup)

# 2) OPACITY (cửa sổ ứng dụng – KHÔNG áp cho Waybar/Wofi/SwayNC) - Đặt độ trong suốt cho cửa sổ (active/inactive)
# - Cú pháp: opacity <active> <inactive> (0.0-1.0; 1.0 = opaque, 0.5 = 50% transparent).
# - Áp dụng regex cho class để match nhiều app tương tự; không áp layer vì layer dùng blur/ignorezero thay opacity.
# - Gợi ý: Opacity cao (0.9+) cho readability; thấp hơn cho ricing glass effect (nhưng có thể chậm GPU yếu).
# Terminals (các terminal emulator phổ biến; opacity 0.90 cho semi-transparent nhẹ)
windowrulev2 = opacity 0.90 0.90, class:^(?i)(kitty|wezterm|alacritty|foot|st|cool-retro-term|tilix|konsole|gnome-terminal)$ # Opacity 90% cho terminals (mờ nhẹ, giữ text sharp)
# CLI monitors & fun (công cụ CLI như monitor system, animation fun; opacity 0.96 cho gần opaque nhưng vẫn glass)
windowrulev2 = opacity 0.96 0.96, class:^(?i)(fastfetch|btop|htop|bashtop|cava|cmatrix|cbonsai|ponysay|cowsay|nyancat|sl|pipes-rs|ueberzugpp|jp2a|fortune|toilet|figlet|lolcat)$ # Opacity 96% cho CLI tools/fun (hiển thị rõ, thêm hiệu ứng blur nếu layer)
# Browsers (trình duyệt web; opacity 0.99 cho gần full opaque vì content heavy)
windowrulev2 = opacity 0.99 0.99, class:^(?i)(firefox|chromium|brave-browser|microsoft-edge(-dev)?)$ # Opacity 99% cho browsers (giữ performance cao, tránh mờ text/web)
# Editors/IDEs (code editors; opacity 0.99 để code rõ ràng)
windowrulev2 = opacity 0.99 0.99, class:^(?i)(code(-oss)?|codium|sublime_text|gvim|emacs|geany)$ # Opacity 99% cho editors (sharp syntax highlight)
# Dunst (notification daemon; là window, không layer - opacity 0.96 cho mờ nhẹ)
windowrulev2 = opacity 0.96 0.96, class:^(?i)dunst$ # Opacity 96% cho Dunst notifications (tích hợp blur nếu config Dunst hỗ trợ)

# 3) LAYERS (Waybar/Wofi/SwayNC/wlogout…) – dùng layerrule để tùy chỉnh layer (overlays)
# - blur: Bật blur background (glass effect).
# - ignorezero: Ignore alpha=0 pixels (transparent parts không blur, giữ sharp edges).
# - noanim: Tắt animation cho layer (tăng speed, tránh lag khi show/hide).
# - Gợi ý: Áp cho gtk-layer-shell apps như Waybar (bar), Wofi (launcher), SwayNC (notifications/control center).
# Waybar (status bar layer)
layerrule = blur, waybar # Bật blur cho Waybar (hiệu ứng glass/mờ nền)
layerrule = ignorezero, waybar # Ignore transparent pixels (giữ edges sharp, tránh blur bleed)
layerrule = noanim, waybar # Tắt animation (Waybar hiện nhanh, không fade/slide)
# Wofi (launcher layer)
layerrule = blur, wofi # Bật blur cho Wofi menu (glass overlay)
layerrule = ignorezero, wofi # Ignore alpha=0 (sharp icons/text)
layerrule = noanim, wofi # Tắt anim (mở menu instant)
# SwayNC (control center + notification window đều là layer)
layerrule = blur, swaync-control-center # Blur cho SwayNC control center
layerrule = ignorezero, swaync-control-center # Ignore transparent (sharp UI elements)
layerrule = noanim, swaync-control-center # No anim (mở nhanh)
layerrule = blur, swaync-notification-window # Blur cho SwayNC notifications
layerrule = ignorezero, swaync-notification-window # Ignore alpha=0 (clear text)
layerrule = noanim, swaync-notification-window # No anim (notify instant)
# (Optional) wlogout / nwgbar / app dùng gtk-layer-shell (logout menu hoặc bar khác)
layerrule = blur, wlogout # Blur cho wlogout (logout dialog)
layerrule = ignorezero, wlogout # Ignore transparent (sharp buttons)
layerrule = noanim, wlogout # No anim (logout quick)

# 4) FLOAT / CENTER / POPUP – dialogs & system tools (cửa sổ thật) - Làm nổi, center, anim popin cho dialogs
# - float: Làm cửa sổ nổi (không tile).
# - center: Center trên màn hình.
# - animation popin: Anim pop in (zoom từ giữa).
# - Áp regex cho title/class để match dialogs phổ biến; gợi ý dùng class cho system tools.
# Generic dialogs (cửa sổ dialog chung như save/open file, confirm, auth)
windowrulev2 = float, center, animation popin, title:^(?i)(File Operation Progress|Save As|Open File|Confirm|Authentication Required|Warning|Info|Properties)$ # Float/center/popin cho dialogs (dựa title regex)
# System utilities / control panels (công cụ hệ thống như network, audio, display manager)
# windowrulev2 = float, center, animation popin, class:^(?i)(float-iwctl|float-nmtui|nmtui|pavucontrol|org\.pulseaudio\.pavucontrol|blueman-manager|nm-connection-editor|gparted|lxappearance|arandr|wdisplays|system-config-printer|virt-manager|simple-scan|gnome-network-displays|deskreen)$ # Float/center/popin cho system tools (uncomment nếu dùng; regex class)
# Quake/Dropdown terminals (terminal dropdown; float/center nếu title match)
windowrulev2 = float, center, animation popin, title:^(?i)(Dropdown Terminal|Quake)$ # Float/center/popin cho quake terminals
# CLI Wi-Fi / network tools trong terminal (gợi ý gọi với class/title custom từ Waybar)
# Khuyên dùng: kitty --class float-nmtui --title nmtui sh -c 'nmtui' (cho nmtui float)
# kitty --class float-iwctl --title iwctl sh -c 'iwctl' (cho iwctl float)

# 5) NOTIFICATIONS (dunst là window) - Float/center/popin cho Dunst (nếu dùng Dunst thay SwayNC)
windowrulev2 = float, center, animation popin, class:^(?i)dunst$ # Float/center/popin cho Dunst notifications (làm nổi như popup)

# 6) SPECIAL CASES - Quy tắc đặc biệt cho app cụ thể (pin, workspace special, v.v.)
# - pin: Pin cửa sổ luôn trên top (không bị che).
# - workspace special:<name>: Đưa vào special workspace (scratchpad-like, toggle ẩn/hiện).
# Calculator luôn nổi phía trên (pin cho calc apps)
windowrulev2 = pin, class:^(?i)(calculator|galculator|qalculate-gtk|gnome-calculator)$ # Pin calculator (luôn top, tiện quick calc)
# Screenshot tools (float/center/popin cho flameshot/gnome-screenshot)
windowrulev2 = float, center, animation popin, class:^(?i)(flameshot|gnome-screenshot)$ # Float/center/popin cho screenshot tools (dễ chọn vùng)
# Scratch workspace (ghi chú/chat luôn nằm workspace đặc biệt; toggle bằng bind SUPER+S)
windowrulev2 = workspace special:scratch, class:^(?i)(obsidian|notion-app|telegram-desktop|zalo|slack|discord|signal)$ # Đưa apps note/chat vào special scratch (ẩn/hiện nhanh)

# 7) FUN / DEMO - Quy tắc vui cho animation/demo apps (float/center/slide)
windowrulev2 = float, center, animation slide, class:^(?i)(cmatrix|nyancat|sl|pipes-rs)$ # Float/center/slide anim cho fun apps (như screensaver/demo)

# =============================
# GỢI Ý TỐI ƯU & TIP NHANH (Optimization Tips)
# =============================
# ▸ Regex advanced: Dùng (?i) cho case-insensitive; ^$ cho exact match; .* cho wildcard (thêm app bằng |appname).
# ▸ Opacity performance: Giảm opacity thấp (dưới 0.8) có thể chậm trên GPU yếu; test với hyprctl keyword decoration:active_opacity.
# ▸ Layer vs Window: Waybar/Wofi là layer (layerrule); Dunst là window (windowrulev2) - check bằng hyprctl layers/clients.
# ▸ Custom class/title: Với kitty/alacritty, dùng --class custom-class để rule riêng (ví dụ: float terminal cho nmtui).
# ▸ Debug rules: Chạy 'hyprctl keyword windowrulev2' để list rules; nếu không apply, check order hoặc specificity.
# ▸ Pro Tips - Siêu Rice:
#   - Thêm blur cho windows: windowrulev2 = blur, class:.* (toàn bộ windows blur, nhưng chỉ nếu enable blur ở decoration).
#   - Anim per-app: animation popin 80% cho dialogs (windowrulev2 = animation popin 80%, title:dialog).
#   - Special multi: Định nghĩa nhiều special workspace (special:notes, special:chat) cho organize scratchpads.
#   - Optimize: Giữ rules minimal - quá nhiều regex chậm matching; group chung nếu có thể.
#   - Nhớ: Rules làm nên ricing - tùy chỉnh để UI "feel glass" (mượt, đẹp, functional)!